<%= render 'shared/breadcrumbs', context: @argument %>

<p class="statement-heading"><%= @argument.text %></p>

<br />

<p>What is the problem with this argument?</p>

<form action="<%= new_counter_argument_path(@argument) %>" method="get" id="fallacy_radio">
  <% Fallacy.common.each do |fallacy| %>
    <label>
      <input type="radio" name="fallacy_name" value="<%= fallacy.name %>" onchange="$('#fallacy_radio').submit();" <%= @fallacy&.name == fallacy.name ? 'checked' : '' %>/>
      <b><%= fallacy.name %></b>:
      <%= fallacy.description %>
    </label><br />
  <% end %>

  <% if Rails.env.test? %><input type="submit" value="Next"><% end %>

</form>

<form action="<%= create_counter_argument_path(@argument) %>" method="post">
  <%= hidden_field_tag :authenticity_token, form_authenticity_token %>

  <input hidden="true" type="text" name="fallacy_name" value="<%= @fallacy&.name %>" />

  <% if @fallacy.name == 'Uncivil' %>
    <p style="color: red">This will be reported to moderators.</p>
  <% end %>

  <% @fallacy.questions&.each do |question| %>
    <p><label>
      <span><%= question['label'] %></span><br />
      <% case question['type']
         when 'text' %>
        <input type="text" name="<%= question['name'] %>" />
      <% when 'select' %>
        <select name="<%= question['name'] %>" />
          <% question['options'].each do |option| %>
            <option value="<%= option %>"><%= option %></option>
          <% end %>
        </select>
      <% end %>
    </label></p>
  <% end %>

  <div class="argument-actions">
    <input type="submit" value="Publish" <%= @fallacy.name.present? ? '' : 'disabled'%>/>
    <%= link_to 'Cancel', @argument %>
  </div>
</form>
